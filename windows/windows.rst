
======================================================
エクスプローラーで見えるフォルダツリー構成
======================================================

エクスプローラーで「ドキュメント」フォルダなどが複数箇所で見えるので、どうなっているかまとめる。

- PC\ドキュメント
- <ユーザー名>\ドキュメント
- C:\Users\<ユーザー名>\ドキュメント



特殊フォルダ
==================


- `【Windows 10】エクスプローラーの「PC」と、「ドキュメント」や「ダウンロード」などの特別なフォルダーについて – ラボラジアン <https://laboradian.com/folders-in-pc-win10/>`__


Windowsの特殊なフォルダ::

                       既定の場所                  PCフォルダに表示
    - 3Dオブジェクト   C:\Users\foo\3D Objects       ○
    - ダウンロード     C:\Users\foo\Downloads        ○
    - デスクトップ     C:\Users\foo\Desktop          ○
    - ドキュメント     C:\Users\foo\Documents        ○
    - ピクチャ         C:\Users\foo\Pictures         ○
    - ビデオ           C:\Users\foo\Videos           ○
    - ミュージック     C:\Users\foo\Music            ○

    - アドレス帳       C:\Users\foo\Contacts
    - お気に入り       C:\Users\foo\Favorites
    - リンク           C:\Users\foo\Links
    - 検索             C:\Users\foo\Searches
    - 保存したゲーム   C:\Users\foo\Saved Games



これらの特殊フォルダは、プロパティに「場所」という項目がある。

これらのフォルダを、「場所」を変えたりしても、OSがきちんとどこにいったか把握しているらしい。
また、移動しても表示名は変わらない。

それがこれ？？::

    HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders

また、英語(Pictures)ではなく日本語(ピクチャ)で表示される。(これはそのフォルダの desktop.ini の機能らしい)




フォルダ階層構造
==================

物理的・具体的には、各ドライブ(C:, D:, ...) をトップとしてツリー構造になっている。

仮想的・抽象的には、下記のようになっている::

    デスクトップ
        PC
            <7つの特殊フォルダ>  --- 実際の物理的な場所によらず、下記の特殊フォルダをリンクしている
                3D オブジェクト, ダウンロード, デスクトップ, ドキュメント,
                ピクチャ, ビデオ, ミュージック
            C:     --- C: 以下の実際のファイルツリー
                Users
                    <ユーザー名>  --- 具体的なユーザーフォルダの場所 (設定によって変えることもできるはず)
        ネットワーク
        <ユーザー名>   --- 仮想的に、ユーザーフォルダの内容 ＋ 特殊フォルダ を見せている
        ゴミ箱     --- 仮想的に各ドライブのゴミ箱を集約して見せているもの
        ライブラリ --- 種類別に、仮想的にいくつかのフォルダを集約して見せる仕組み
        OneDrive   --- OneDrive の内容がマウントされている
        Box        --- Box.com の内容がマウントされている
        <実際にデスクトップに置いてあるファイルとフォルダ>


エクスプローラーのナビゲーションウィンドウで右クリック「全てのフォルダの表示」

- ON  --- 一番上のデスクトップからツリーが表示される
- OFF --- 一番上のデスクトップは表示されず、その下からツリーが表示される


特殊フォルダ (例えば「ドキュメント」は) は、下記の3つの位置に見える

- (具体的) C:\Users\<ユーザー名>\ドキュメント    (初期状態。移動したりすれば違う場所)
- (仮想)   PC\ドキュメント
- (仮想)   <ユーザー名>\ドキュメント


特殊フォルダの「場所」を、c:\Users\foo から別な場所に移動した場合、

- c:\Users\<ユーザー名> にはないが、
- <ユーザー名> にはあるように見える。



エクスプローラーのお節介
==============================

エクスプローラーはパスを意識しているので、ツリーを上からたどっていけば上記3つは区別できる。

問題は、
エクスプローラーは、アドレスバーに  c:\Users\foo と入力した場合、
気を利かして、ユーザーフォルダにリダイレクトする。。。


::

    ユーザーフォルダ
        %USERPROFILE%           -> (仮想的な)ユーザーフォルダ
        c:\Users\<ユーザー名>   -> (仮想的な)ユーザーフォルダ
        %HOMEPATH%              -> (具体的な) C:\Users\<ユーザー名>
        shell:profile           -> (具体的な) C:\Users\<ユーザー名>



shell: で使えるフォルダ名

- HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FolderDescriptions
- `Windows 10 shell コマンドで開く特殊フォルダの一覧 <https://www.tipsfound.com/windows10/07010>`__















